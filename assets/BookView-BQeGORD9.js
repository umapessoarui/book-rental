import{d as V,r as v,c as h,a as r,b as _,e,w as D,f as g,v as $,t as n,o as d,g as w,_ as M,h as P,u as S,i as O,F as x,j as A}from"./index-DkS7fPdL.js";import{g as F}from"./bookServices-LI-ppAcb.js";const T={key:0,class:"modal"},q={class:"modal__content"},I={key:0,class:"modal__error"},U={key:1,class:"modal__error"},j={class:"modal__row"},E={key:0,class:"modal__error"},L={class:"modal__cvv"},R={key:0,class:"modal__error"},H=["disabled"],z={key:0,class:"modal__loader"},G={key:1},J=V({__name:"PaymentModal",props:{isOpen:{type:Boolean}},emits:["close","paymentSuccess"],setup(N,{emit:f}){const s=N,c=f,p=v(""),b=v(""),m=v(""),y=v(""),i=v(!1),o=v({cardNumber:!1,cardName:!1,expiryDate:!1,cvv:!1}),u=h(()=>{const t={};return o.value.cardNumber&&!/^\d{16}$/.test(p.value.replace(/\s/g,""))&&(t.cardNumber="Número do cartão deve ter 16 dígitos"),o.value.cardName&&!b.value.trim()&&(t.cardName="Nome no cartão é obrigatório"),o.value.expiryDate&&!/^\d{2}\/\d{2}$/.test(m.value)&&(t.expiryDate="Data deve estar no formato MM/AA"),o.value.cvv&&!/^\d{3}$/.test(y.value)&&(t.cvv="CVV deve ter 3 dígitos"),t}),k=h(()=>Object.keys(u.value).length===0),B=async()=>{Object.keys(o.value).forEach(t=>o.value[t]=!0),k.value&&(i.value=!0,await new Promise(t=>setTimeout(t,2e3)),i.value=!1,w.addToast("Pagamento aprovado com sucesso!","success"),c("paymentSuccess"),c("close"))},C=()=>{let t=m.value.replace(/\D/g,"").slice(0,4);t.length>=2&&(t=t.replace(/(\d{2})(\d{0,2})/,"$1/$2")),m.value=t};return(t,a)=>s.isOpen?(d(),r("div",T,[e("div",{class:"modal__overlay",onClick:a[0]||(a[0]=l=>c("close"))}),e("div",q,[e("button",{class:"modal__close-btn",onClick:a[1]||(a[1]=l=>c("close"))},"✖"),a[14]||(a[14]=e("h2",{class:"modal__title"},"Pagamento com Cartão de Crédito",-1)),e("form",{class:"modal__form",onSubmit:D(B,["prevent"])},[a[12]||(a[12]=e("label",{class:"modal__label"},"Número do Cartão",-1)),g(e("input",{class:"modal__input",type:"text","onUpdate:modelValue":a[2]||(a[2]=l=>p.value=l),placeholder:"**** **** **** ****",required:"",maxlength:"19",onBlur:a[3]||(a[3]=l=>o.value.cardNumber=!0)},null,544),[[$,p.value]]),u.value.cardNumber?(d(),r("span",I,n(u.value.cardNumber),1)):_("",!0),a[13]||(a[13]=e("label",{class:"modal__label"},"Nome no Cartão",-1)),g(e("input",{class:"modal__input",type:"text","onUpdate:modelValue":a[4]||(a[4]=l=>b.value=l),placeholder:"Nome completo",required:"",onBlur:a[5]||(a[5]=l=>o.value.cardName=!0)},null,544),[[$,b.value]]),u.value.cardName?(d(),r("span",U,n(u.value.cardName),1)):_("",!0),e("div",j,[e("div",null,[a[10]||(a[10]=e("label",{class:"modal__label"},"Validade",-1)),g(e("input",{class:"modal__input",type:"text","onUpdate:modelValue":a[6]||(a[6]=l=>m.value=l),placeholder:"MM/AA",required:"",maxlength:"5",onInput:C,onBlur:a[7]||(a[7]=l=>o.value.expiryDate=!0)},null,544),[[$,m.value]]),u.value.expiryDate?(d(),r("span",E,n(u.value.expiryDate),1)):_("",!0)]),e("div",L,[a[11]||(a[11]=e("label",{class:"modal__label"},"CVV",-1)),g(e("input",{class:"modal__input",type:"text","onUpdate:modelValue":a[8]||(a[8]=l=>y.value=l),placeholder:"***",required:"",maxlength:"3",onBlur:a[9]||(a[9]=l=>o.value.cvv=!0)},null,544),[[$,y.value]]),u.value.cvv?(d(),r("span",R,n(u.value.cvv),1)):_("",!0)])]),e("button",{type:"submit",class:"modal__pay-btn",disabled:!k.value||i.value},[i.value?(d(),r("span",z)):(d(),r("span",G,"Alugar"))],8,H)],32)])])):_("",!0)}}),K=M(J,[["__scopeId","data-v-647d6594"]]),Q={key:0,class:"book-detail"},W={class:"book-detail__container"},X={class:"book-detail__header"},Y={class:"book-detail__cover"},Z=["src","alt"],ee={class:"book-detail__info"},ae={class:"book-detail__title"},oe={class:"book-detail__authors"},te={class:"book-detail__author"},se={key:0},le={class:"book-detail__meta"},ne={class:"book-detail__description"},re=["innerHTML"],de=V({__name:"BookView",setup(N){const f=S(),s=v(null),c=v(!1),p=()=>{c.value=!0},b=()=>{c.value=!1},m=()=>{console.log("Pagamento realizado com sucesso!")};async function y(i){s.value=await F(i)}return P(()=>{f.params.id&&y(f.params.id)}),(i,o)=>(d(),r(x,null,[s.value?(d(),r("div",Q,[e("div",W,[e("div",X,[e("div",Y,[e("img",{src:s.value.thumbnail,alt:s.value.title},null,8,Z)]),e("div",ee,[e("h1",ae,n(s.value.title),1),e("p",oe,[(d(!0),r(x,null,A(s.value.author,(u,k)=>(d(),r("span",{key:k},[e("span",te,n(u),1),k<s.value.author.length-1?(d(),r("span",se," • ")):_("",!0)]))),128))])])]),e("div",le,[e("span",null,n(i.$t("book.rating"))+" "+n(s.value.averageRating),1),o[0]||(o[0]=e("span",null," - ",-1)),e("span",null,n(s.value.pageCount)+" "+n(i.$t("book.pages")),1)]),e("button",{class:"book-detail__buy",onClick:p},n(i.$t("book.rent"))+" R$ "+n(s.value.price.toFixed(2)),1),e("div",ne,[o[1]||(o[1]=e("h3",null,"Sobre este e-book",-1)),e("p",{innerHTML:s.value.description},null,8,re)])])])):_("",!0),O(K,{isOpen:c.value,onClose:b,onPaymentSuccess:m},null,8,["isOpen"])],64))}}),ce=M(de,[["__scopeId","data-v-5a40f399"]]);export{ce as default};
